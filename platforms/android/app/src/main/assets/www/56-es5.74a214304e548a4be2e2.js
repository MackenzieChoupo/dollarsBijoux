function _classCallCheck(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(n,t){for(var e=0;e<t.length;e++){var l=t[e];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(n,l.key,l)}}function _createClass(n,t,e){return t&&_defineProperties(n.prototype,t),e&&_defineProperties(n,e),n}(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{"JyM/":function(n,t,e){"use strict";e.r(t);var l=e("8Y7J"),i=e("ZZ/e"),o=e("egMn"),r=e("HBAR"),u=e("UmVP"),a=e("sf9b"),s=e("KTio"),c=e("PpuG"),h=function(){function n(t,e,l,i,o,r,u,a,s,c){var h=this;_classCallCheck(this,n),this.navCtrl=t,this.shared=e,this.http=l,this.storage=i,this.spinnerDialog=o,this.config=r,this.loading=u,this.location=a,this.themeableBrowser=s,this.applicationRef=c,this.shippingMethod=new Array,this.selectedMethod=!0,this.shippingLocations=[],this.resetPage=!1,console.log(this.shared.customerData),this.shared.translateString(this.shared.checkOutPageText).then((function(n){h.shared.checkOutPageText=n})),this.getShippingZones()}return _createClass(n,[{key:"getShippingZones",value:function(){var n=this;this.loading.show(),this.config.getWoo("shipping/zones?"+this.config.productsArguments).then((function(t){n.getShippingLocations(t)}))}},{key:"getShippingLocations",value:function(n){var t=this,e=0,l=!0,i=!1,o=void 0;try{for(var r,u=function(){var l=r.value;t.config.getWoo("shipping/zones/"+l.id+"/locations?"+t.config.productsArguments).then((function(i){e++;var o=i,r=!0,u=!1,a=void 0;try{for(var s,c=o[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var h=s.value;t.shippingLocations.push(Object.assign(h,{zoneId:l.id}))}}catch(d){u=!0,a=d}finally{try{r||null==c.return||c.return()}finally{if(u)throw a}}n.length==e&&(t.loading.hide(),t.sortArray(t.shippingLocations))}))},a=n[Symbol.iterator]();!(l=(r=a.next()).done);l=!0)u()}catch(s){i=!0,o=s}finally{try{l||null==a.return||a.return()}finally{if(i)throw o}}}},{key:"sortArray",value:function(n){var t=[],e=!0,l=!1,i=void 0;try{for(var o,r=n[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var u=o.value;"postcode"==u.type&&t.push(u)}}catch(P){l=!0,i=P}finally{try{e||null==r.return||r.return()}finally{if(l)throw i}}var a=!0,s=!1,c=void 0;try{for(var h,d=n[Symbol.iterator]();!(a=(h=d.next()).done);a=!0){var p=h.value;"state"==p.type&&t.push(p)}}catch(P){s=!0,c=P}finally{try{a||null==d.return||d.return()}finally{if(s)throw c}}var f=!0,b=!1,g=void 0;try{for(var v,y=n[Symbol.iterator]();!(f=(v=y.next()).done);f=!0){var m=v.value;"country"==m.type&&t.push(m)}}catch(P){b=!0,g=P}finally{try{f||null==y.return||y.return()}finally{if(b)throw g}}var _=!0,k=!1,C=void 0;try{for(var S,A=n[Symbol.iterator]();!(_=(S=A.next()).done);_=!0){var w=S.value;"continent"==w.type&&t.push(w)}}catch(P){k=!0,C=P}finally{try{_||null==A.return||A.return()}finally{if(k)throw C}}console.log(t),this.findZoneId(t)}},{key:"findZoneId",value:function(n){var t="",e=!0,l=!1,i=void 0;try{for(var o,r=n[Symbol.iterator]();!(e=(o=r.next()).done);e=!0){var u=o.value;if("postcode"==u.type){if(this.matchPostCode(u)){t=u.zoneId,console.log("postcode  "+u.code);break}}else if("state"==u.type){if(this.matchState(u)){console.log("state  "+u.code),t=u.zoneId;break}}else if("country"==u.type){if(this.matchCountry(u)){console.log("country  "+u.code),t=u.zoneId;break}}else if("continent"==u.type&&this.matchContinent(u)){console.log("continent  "+u.code),t=u.zoneId;break}}}catch(a){l=!0,i=a}finally{try{e||null==r.return||r.return()}finally{if(l)throw i}}this.getShippingMethods(t)}},{key:"matchPostCode",value:function(n){var t=this.shared.shipping.postcode;if(n.code.toUpperCase()==t.toUpperCase())return!0;if(n.code.indexOf("*")>0){var e=n.code.indexOf("*"),l=t.substring(0,e-1),i=n.code.substring(0,e-1);if(l.toUpperCase()==i.toUpperCase())return!0}if(n.code.indexOf(".")>0){var o=n.code.indexOf("."),r=n.code.substring(0,o),u=n.code.substring(o+3,n.code.length);r=parseInt(r);var a=parseInt(t);if(u=parseInt(u),a>=r&&a<=u)return!0}}},{key:"matchState",value:function(n){if(this.shared.shipping.country+":"+this.shared.shipping.state==n.code)return!0}},{key:"matchCountry",value:function(n){if(this.shared.shipping.country==n.code)return!0}},{key:"matchContinent",value:function(n){if(this.location.getContientCode(this.shared.shipping.country)==n.code)return!0}},{key:"getShippingMethods",value:function(n){var t=this;""==n&&(n=0),this.loading.show(),this.config.getWoo("shipping/zones/"+n+"/methods?"+this.config.productsArguments).then((function(n){t.loading.hide(),t.shippingMethod=n,t.applicationRef.tick()}))}},{key:"setMethod",value:function(n){this.shared.shipping_lines=[];var t={};if("flat_rate"==n.method_id)t={ship_id:n.id,method_id:n.method_id,method_title:n.method_title,title:n.title,total:this.calculateFlatRate(n)};else if(n.settings.cost){var e=n.settings.cost.value.toString();""==e&&(e="0"),t={ship_id:n.id,method_id:n.method_id,method_title:n.method_title,title:n.title,total:e}}else t={ship_id:n.id,method_id:n.method_id,method_title:n.method_title,title:n.title,total:"0"};console.log(t),this.shared.shipping_lines.push(t)}},{key:"calculateFlatRate",value:function(n){var t=n.settings.cost.value.toString();return""==t&&(t="0"),t}},{key:"checkFreeShipping",value:function(n){return"free_shipping"!=n.method_id||""==n.settings.requires.value||("coupon"==n.settings.requires.value?!!this.findFreeShippingCoupon():"both"==n.settings.requires.value?!!(this.shared.productsTotal()>=n.settings.min_amount.value&&this.findFreeShippingCoupon()):"either"==n.settings.requires.value?!!(this.shared.productsTotal()>=n.settings.min_amount.value||this.findFreeShippingCoupon()):"min_amount"==n.settings.requires.value?this.shared.productsTotal()>=n.settings.min_amount.value:void 0)}},{key:"findFreeShippingCoupon",value:function(){var n=!1;if(0==this.shared.couponArray.length)return!1;var t=!0,e=!1,l=void 0;try{for(var i,o=this.shared.couponArray[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){1==i.value.free_shipping&&(n=!0)}}catch(r){e=!0,l=r}finally{try{t||null==o.return||o.return()}finally{if(e)throw l}}return 1==n}},{key:"proceedOrder",value:function(){2==this.config.checkOutPage?this.navCtrl.navigateForward("order"):this.openOrderPage()}},{key:"openOrderPage",value:function(){var n=0;null!=this.shared.customerData.id&&(n=this.shared.customerData.id);var t=null;null!=this.shared.customerData.cookie&&(t=this.shared.customerData.cookie);var e=this.config.checkOutPage,l={token:t,billing_info:this.shared.billing,shipping_info:this.shared.shipping,products:this.getProducts(),shipping_ids:this.shared.shipping_lines,coupons:this.getCoupons(),customer_note:"",customer_id:n,sameAddress:this.shared.sameAddress,one_page:e,platform:this.shared.device};console.log(l),this.shared.openCheckoutWebview(l)}},{key:"getProducts",value:function(){var n=[],t=!0,e=!1,l=void 0;try{for(var i,o=this.shared.cartProducts[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var r=i.value,u={quantity:r.quantity,product_id:r.product_id,total:r.total.toString()};r.variation_id&&Object.assign(u,{variation_id:r.variation_id}),n.push(u)}}catch(a){e=!0,l=a}finally{try{t||null==o.return||o.return()}finally{if(e)throw l}}return n}},{key:"getCoupons",value:function(){var n=[],t=!0,e=!1,l=void 0;try{for(var i,o=this.shared.couponArray[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var r=i.value;n.push({code:r.code,discount:r.amount})}}catch(u){e=!0,l=u}finally{try{t||null==o.return||o.return()}finally{if(e)throw l}}return n}},{key:"getShippingLines",value:function(){var n=[],t=!0,e=!1,l=void 0;try{for(var i,o=this.shared.shipping_lines[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var r=i.value;n.push({code:r.code,discount:r.amount})}}catch(u){e=!0,l=u}finally{try{t||null==o.return||o.return()}finally{if(e)throw l}}return n}},{key:"updateUser",value:function(){var n=this;this.config.Woocommerce.putAsync("customers/"+this.shared.customerData.id,{billing:this.shared.billing,shipping:this.shared.shipping}).then((function(t){var e=t;n.shared.customerData.billing=e.billing,n.shared.customerData.shipping=e.shipping,n.storage.set("customerData",n.shared.customerData)}))}},{key:"ionViewDidEnter",value:function(){var n=this;this.resetPage=!1,setTimeout((function(){n.resetPage=!0}),100),this.shared.shipping_lines=[]}},{key:"ngOnInit",value:function(){}}]),n}(),d=function n(){_classCallCheck(this,n)},p=e("pMnS"),f=e("oBZk"),b=e("SVse"),g=e("s7LF"),v=e("taci"),y=e("4How"),m=e("IheW"),_=e("xgBC"),k=l.zb({encapsulation:0,styles:[["ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]{background:#fafafa}ion-content[_ngcontent-%COMP%]   ion-list[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background:#eee}ion-footer[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:45px;margin:0}"]],data:{}});function C(n){return l.Wb(0,[(n()(),l.Bb(0,0,null,null,2,"span",[],null,null,null,null,null)),(n()(),l.Ub(1,null,["",""])),l.Qb(2,1)],null,(function(n,t){var e=l.Vb(t,1,0,n(t,2,0,l.Nb(t.parent.parent.parent.parent,1),t.parent.parent.context.$implicit.settings.cost.value));n(t,1,0,e)}))}function S(n){return l.Wb(0,[(n()(),l.Bb(0,0,null,null,11,"ion-item",[["lines","full"]],null,null,null,f.Ab,f.y)),l.Ab(1,49152,null,0,i.J,[l.j,l.p,l.F],{lines:[0,"lines"]},null),(n()(),l.Bb(2,0,null,0,4,"ion-label",[],null,null,null,f.Bb,f.B)),l.Ab(3,49152,null,0,i.P,[l.j,l.p,l.F],null,null),(n()(),l.Ub(4,0,[""," "])),(n()(),l.qb(16777216,null,0,1,null,C)),l.Ab(6,16384,null,0,b.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(n()(),l.Bb(7,0,null,0,4,"ion-radio",[],null,[[null,"ionSelect"],[null,"ionBlur"]],(function(n,t,e){var i=!0,o=n.component;return"ionBlur"===t&&(i=!1!==l.Nb(n,11)._handleBlurEvent(e.target)&&i),"ionSelect"===t&&(i=!1!==l.Nb(n,11)._handleIonSelect(e.target)&&i),"ionSelect"===t&&(i=!1!==o.setMethod(n.parent.context.$implicit)&&i),i}),f.Hb,f.G)),l.Rb(5120,null,g.e,(function(n){return[n]}),[i.Qb]),l.Ab(9,49152,null,0,i.cb,[l.j,l.p,l.F],{value:[0,"value"]},null),l.Ob(10,1),l.Ab(11,16384,null,0,i.Qb,[l.p],null,null)],(function(n,t){n(t,1,0,"full"),n(t,6,0,t.parent.context.$implicit.settings.cost);var e=n(t,10,0,t.parent.context.$implicit);n(t,9,0,e)}),(function(n,t){n(t,4,0,t.parent.context.$implicit.title)}))}function A(n){return l.Wb(0,[(n()(),l.Bb(0,0,null,null,2,"div",[],null,null,null,null,null)),(n()(),l.qb(16777216,null,null,1,null,S)),l.Ab(2,16384,null,0,b.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null)],(function(n,t){n(t,2,0,t.context.$implicit.enabled&&t.component.checkFreeShipping(t.context.$implicit))}),null)}function w(n){return l.Wb(0,[(n()(),l.Bb(0,0,null,null,7,"ion-list",[["class","ion-padding"]],null,null,null,f.Cb,f.C)),l.Ab(1,49152,null,0,i.Q,[l.j,l.p,l.F],null,null),(n()(),l.Bb(2,0,null,0,5,"ion-radio-group",[],null,[[null,"ionBlur"],[null,"ionChange"]],(function(n,t,e){var i=!0;return"ionBlur"===t&&(i=!1!==l.Nb(n,5)._handleBlurEvent(e.target)&&i),"ionChange"===t&&(i=!1!==l.Nb(n,5)._handleChangeEvent(e.target)&&i),i}),f.Gb,f.H)),l.Rb(5120,null,g.e,(function(n){return[n]}),[i.Sb]),l.Ab(4,49152,null,0,i.db,[l.j,l.p,l.F],null,null),l.Ab(5,16384,null,0,i.Sb,[l.p],null,null),(n()(),l.qb(16777216,null,0,1,null,A)),l.Ab(7,278528,null,0,b.j,[l.W,l.S,l.x],{ngForOf:[0,"ngForOf"]},null)],(function(n,t){n(t,7,0,t.component.shippingMethod)}),null)}function P(n){return l.Wb(0,[l.Pb(0,v.a,[u.a]),l.Pb(0,y.a,[]),(n()(),l.Bb(2,0,null,null,12,"ion-header",[],null,null,null,f.sb,f.s)),l.Ab(3,49152,null,0,i.D,[l.j,l.p,l.F],null,null),(n()(),l.Bb(4,0,null,0,10,"ion-toolbar",[],null,null,null,f.Zb,f.Z)),l.Ab(5,49152,null,0,i.Eb,[l.j,l.p,l.F],null,null),(n()(),l.Bb(6,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,f.fb,f.f)),l.Ab(7,49152,null,0,i.n,[l.j,l.p,l.F],null,null),(n()(),l.Bb(8,0,null,0,2,"ion-back-button",[["icon","arrow-round-back"]],null,[[null,"click"]],(function(n,t,e){var i=!0;return"click"===t&&(i=!1!==l.Nb(n,10).onClick(e)&&i),i}),f.cb,f.c)),l.Ab(9,49152,null,0,i.i,[l.j,l.p,l.F],{icon:[0,"icon"]},null),l.Ab(10,16384,null,0,i.j,[[2,i.kb],i.Lb],null,null),(n()(),l.Bb(11,0,null,0,3,"ion-title",[],null,null,null,f.Xb,f.X)),l.Ab(12,49152,null,0,i.Cb,[l.j,l.p,l.F],null,null),(n()(),l.Ub(13,0,["",""])),l.Qb(14,1),(n()(),l.Bb(15,0,null,null,3,"ion-content",[],null,null,null,f.nb,f.n)),l.Ab(16,49152,null,0,i.w,[l.j,l.p,l.F],null,null),(n()(),l.qb(16777216,null,0,1,null,w)),l.Ab(18,16384,null,0,b.k,[l.W,l.S],{ngIf:[0,"ngIf"]},null),(n()(),l.Bb(19,0,null,null,5,"ion-footer",[],null,null,null,f.qb,f.q)),l.Ab(20,49152,null,0,i.B,[l.j,l.p,l.F],null,null),(n()(),l.Bb(21,0,null,0,3,"ion-button",[["color","secondary"],["expand","full"]],null,[[null,"click"]],(function(n,t,e){var l=!0;return"click"===t&&(l=!1!==n.component.proceedOrder()&&l),l}),f.eb,f.e)),l.Ab(22,49152,null,0,i.m,[l.j,l.p,l.F],{color:[0,"color"],disabled:[1,"disabled"],expand:[2,"expand"]},null),(n()(),l.Ub(23,0,[" ",""])),l.Qb(24,1)],(function(n,t){var e=t.component;n(t,9,0,"arrow-round-back"),n(t,18,0,e.resetPage),n(t,22,0,"secondary",0==e.shared.shipping_lines.length,"full")}),(function(n,t){var e=l.Vb(t,13,0,n(t,14,0,l.Nb(t,0),"Mode de livraison"));n(t,13,0,e);var i=l.Vb(t,23,0,n(t,24,0,l.Nb(t,0),"suivant"));n(t,23,0,i)}))}var x=l.xb("app-shipping-method",h,(function(n){return l.Wb(0,[(n()(),l.Bb(0,0,null,null,1,"app-shipping-method",[],null,null,null,P,k)),l.Ab(1,114688,null,0,h,[i.Lb,u.a,m.c,_.b,o.a,a.a,s.a,c.a,r.a,l.g],null,null)],(function(n,t){n(t,1,0)}),null)}),{},{},[]),B=e("iInd"),F=e("wWlB");e.d(t,"ShippingMethodPageModuleNgFactory",(function(){return O}));var O=l.yb(d,[],(function(n){return l.Kb([l.Lb(512,l.m,l.jb,[[8,[p.a,x]],[3,l.m],l.D]),l.Lb(4608,b.m,b.l,[l.z,[2,b.v]]),l.Lb(4608,g.m,g.m,[]),l.Lb(4608,i.c,i.c,[l.F,l.g]),l.Lb(4608,i.Kb,i.Kb,[i.c,l.m,l.w]),l.Lb(4608,i.Pb,i.Pb,[i.c,l.m,l.w]),l.Lb(1073742336,b.b,b.b,[]),l.Lb(1073742336,g.l,g.l,[]),l.Lb(1073742336,g.c,g.c,[]),l.Lb(1073742336,i.Gb,i.Gb,[]),l.Lb(1073742336,B.o,B.o,[[2,B.t],[2,B.m]]),l.Lb(1073742336,F.a,F.a,[]),l.Lb(1073742336,d,d,[]),l.Lb(1024,B.k,(function(){return[[{path:"",component:h}]]}),[])])}))}}]);